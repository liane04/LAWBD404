@{
    ViewData["Title"] = "Detalhes do Anúncio";
}

<!-- Breadcrumb Navigation -->
<nav aria-label="breadcrumb" class="bg-light border-bottom">
    <div class="container">
        <ol class="breadcrumb py-3 mb-0">
            <li class="breadcrumb-item"><a href="/"><i class="bi bi-house-door-fill me-1"></i>Início</a></li>
            <li class="breadcrumb-item"><a href="/Anuncios">Anúncios</a></li>
            <li class="breadcrumb-item active" aria-current="page">BMW Série 3 320d</li>
        </ol>
    </div>
</nav>

<div class="container my-5">
    <div class="row">
        <!-- Coluna Principal: Imagens e Detalhes -->
        <div class="col-lg-8">
            <!-- Título e Preço -->
            <div class="mb-4">
                <div class="d-flex align-items-start justify-content-between mb-3">
                    <div>
                        <h1 class="h2 mb-2">BMW Série 3 320d Pack M</h1>
                        <div class="d-flex gap-2 flex-wrap">
                            <span class="badge bg-success"><i class="bi bi-check-circle-fill me-1"></i>Verificado</span>
                            <span class="badge bg-primary"><i class="bi bi-star-fill me-1"></i>Destaque</span>
                            <span class="badge bg-info text-dark"><i class="bi bi-clock-fill me-1"></i>Publicado há 2 dias</span>
                        </div>
                    </div>
                    <div class="d-flex gap-2">
                        <button class="btn btn-outline-secondary" title="Partilhar" data-bs-toggle="dropdown">
                            <i class="bi bi-share-fill"></i>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#"><i class="bi bi-facebook me-2 text-primary"></i>Facebook</a></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-whatsapp me-2 text-success"></i>WhatsApp</a></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-envelope-fill me-2 text-danger"></i>Email</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-link-45deg me-2"></i>Copiar Link</a></li>
                        </ul>
                        <button class="btn btn-outline-danger" onclick="toggleFavoritoDetails(this)" title="Adicionar aos Favoritos">
                            <i class="bi bi-heart"></i>
                        </button>
                    </div>
                </div>
                <div class="price-section p-3 bg-light rounded-3 border">
                    <div class="d-flex align-items-center justify-content-between">
                        <div>
                            <p class="text-muted mb-1 small">Preço:</p>
                            <h2 class="text-primary fw-bold mb-0">28.500 €</h2>
                        </div>
                        <div class="text-end">
                            <p class="text-muted mb-1 small">Valor estimado:</p>
                            <p class="mb-0 fw-semibold text-success"><i class="bi bi-graph-up-arrow me-1"></i>Bom negócio</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Galeria de Imagens (Carrossel) -->
            <div class="gallery-container mb-4">
                <div id="galleryCarousel" class="carousel slide shadow-lg rounded-3 overflow-hidden" data-bs-ride="carousel">
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <img src="~/imagens/bmwSerie1.jpg" class="d-block w-100 gallery-main-image" alt="Frente do carro" onclick="openFullscreen(0)">
                        </div>
                        <div class="carousel-item">
                            <img src="https://placehold.co/800x600/343a40/e9ecef?text=Interior" class="d-block w-100 gallery-main-image" alt="Interior do carro" onclick="openFullscreen(1)">
                        </div>
                        <div class="carousel-item">
                            <img src="https://placehold.co/800x600/343a40/e9ecef?text=Traseira" class="d-block w-100 gallery-main-image" alt="Traseira do carro" onclick="openFullscreen(2)">
                        </div>
                        <div class="carousel-item">
                            <img src="https://placehold.co/800x600/343a40/e9ecef?text=Lateral" class="d-block w-100 gallery-main-image" alt="Lateral do carro" onclick="openFullscreen(3)">
                        </div>
                        <div class="carousel-item">
                            <img src="https://placehold.co/800x600/343a40/e9ecef?text=Painel" class="d-block w-100 gallery-main-image" alt="Painel do carro" onclick="openFullscreen(4)">
                        </div>
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#galleryCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Anterior</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#galleryCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Seguinte</span>
                    </button>
                    <button class="btn btn-light btn-fullscreen" onclick="openFullscreen(0)">
                        <i class="bi bi-arrows-fullscreen"></i>
                    </button>
                </div>

                <!-- Miniaturas -->
                <div class="gallery-thumbnails mt-3">
                    <div class="thumbnail-item active" onclick="goToSlide(0)">
                        <img src="~/imagens/bmwSerie1.jpg" alt="Thumb 1">
                    </div>
                    <div class="thumbnail-item" onclick="goToSlide(1)">
                        <img src="https://placehold.co/150x100/343a40/e9ecef?text=Interior" alt="Thumb 2">
                    </div>
                    <div class="thumbnail-item" onclick="goToSlide(2)">
                        <img src="https://placehold.co/150x100/343a40/e9ecef?text=Traseira" alt="Thumb 3">
                    </div>
                    <div class="thumbnail-item" onclick="goToSlide(3)">
                        <img src="https://placehold.co/150x100/343a40/e9ecef?text=Lateral" alt="Thumb 4">
                    </div>
                    <div class="thumbnail-item" onclick="goToSlide(4)">
                        <img src="https://placehold.co/150x100/343a40/e9ecef?text=Painel" alt="Thumb 5">
                    </div>
                    <div class="thumbnail-item view-all">
                        <i class="bi bi-grid-3x3-gap-fill"></i>
                        <span>Ver todas (5)</span>
                    </div>
                </div>
            </div>

            <!-- Detalhes Rápidos -->
            <div class="card shadow-sm mb-4">
                <div class="card-body anuncio-details-grid-details-page">
                    <span><i class="bi bi-calendar3"></i> 2019</span>
                    <span><i class="bi bi-speedometer2"></i> 98.000 km</span>
                    <span><i class="bi bi-fuel-pump-fill"></i> Diesel</span>
                    <span><i class="bi bi-gear-fill"></i> Manual</span>
                    <span><i class="bi bi-palette-fill"></i> Cinzento</span>
                    <span><i class="bi bi-person-check-fill"></i> Particular</span>
                </div>
            </div>


            <!-- Descrição -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0"><i class="bi bi-file-text-fill me-2"></i>Descrição</h4>
                </div>
                <div class="card-body">
                    <p class="mb-2">Carro nacional em excelente estado, com todas as revisões na marca. Pack M completo, interior e exterior. Viatura muito estimada e com um consumo médio de 5L/100km. Não fumador.</p>
                    <p class="mb-0">Equipado com GPS profissional, bancos desportivos em alcântara, jantes de 18 polegadas, faróis LED e sensores de estacionamento à frente e atrás.</p>
                </div>
            </div>

            <!-- Especificações Técnicas -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0"><i class="bi bi-gear-wide-connected me-2"></i>Especificações Técnicas</h4>
                </div>
                <div class="card-body p-0">
                    <div class="specifications-grid">
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-building"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Marca</span>
                                <span class="spec-value">BMW</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-car-front"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Modelo</span>
                                <span class="spec-value">Série 3</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-calendar3"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Ano</span>
                                <span class="spec-value">2019</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-speedometer2"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Quilómetros</span>
                                <span class="spec-value">98.000 km</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-fuel-pump-fill"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Combustível</span>
                                <span class="spec-value">Diesel</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-gear-fill"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Caixa</span>
                                <span class="spec-value">Manual</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-lightning-charge-fill"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Potência</span>
                                <span class="spec-value">190 cv</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-speedometer"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Cilindrada</span>
                                <span class="spec-value">1995 cm³</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-palette-fill"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Cor</span>
                                <span class="spec-value">Cinzento</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-door-closed-fill"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Portas</span>
                                <span class="spec-value">4</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-people-fill"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Lugares</span>
                                <span class="spec-value">5</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-shield-fill-check"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Estado</span>
                                <span class="spec-value">Usado</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Extras e Equipamentos -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0"><i class="bi bi-star-fill me-2"></i>Extras e Equipamentos</h4>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3"><i class="bi bi-shield-check me-2"></i>Segurança</h6>
                            <ul class="list-unstyled extras-list">
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>ABS</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Airbags (6)</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Controlo de Estabilidade</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Sensores Estacionamento</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Câmara Traseira</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3"><i class="bi bi-lightning-charge me-2"></i>Conforto</h6>
                            <ul class="list-unstyled extras-list">
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Ar Condicionado Automático</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Bancos em Pele/Alcântara</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Bancos Aquecidos</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Volante Multifunções</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Cruise Control</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3"><i class="bi bi-speaker me-2"></i>Multimédia</h6>
                            <ul class="list-unstyled extras-list">
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Sistema Navegação GPS</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Bluetooth</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Ecrã Tátil</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>USB/AUX</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3"><i class="bi bi-tools me-2"></i>Outros</h6>
                            <ul class="list-unstyled extras-list">
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Jantes Liga Leve 18"</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Faróis LED</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Pack M Sport</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Vidros Escurecidos</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Coluna Lateral: Vendedor e Contacto -->
        <div class="col-lg-4">
            <!-- Seller Card -->
            <div class="seller-card card shadow-sm sticky-top mb-4">
                <div class="card-body text-center">
                    <div class="position-relative d-inline-block mb-3">
                        <img src="https://placehold.co/100x100/0d6efd/ffffff?text=User" class="rounded-circle seller-avatar" alt="Foto do Vendedor">
                        <span class="badge-verified"><i class="bi bi-patch-check-fill"></i></span>
                    </div>
                    <h5 class="card-title mb-1">Pedro Costa</h5>
                    <p class="text-muted mb-2">Membro desde 2021</p>

                    <!-- Rating -->
                    <div class="seller-rating mb-3">
                        <div class="stars mb-1">
                            <i class="bi bi-star-fill text-warning"></i>
                            <i class="bi bi-star-fill text-warning"></i>
                            <i class="bi bi-star-fill text-warning"></i>
                            <i class="bi bi-star-fill text-warning"></i>
                            <i class="bi bi-star-half text-warning"></i>
                        </div>
                        <small class="text-muted">4.5 (28 avaliações)</small>
                    </div>

                    <!-- Seller Stats -->
                    <div class="seller-stats mb-3">
                        <div class="row text-center g-2">
                            <div class="col-6">
                                <div class="stat-box p-2 bg-light rounded">
                                    <div class="stat-number text-primary fw-bold">12</div>
                                    <div class="stat-label small text-muted">Anúncios</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="stat-box p-2 bg-light rounded">
                                    <div class="stat-number text-success fw-bold">98%</div>
                                    <div class="stat-label small text-muted">Resposta</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-lg">
                            <i class="bi bi-telephone-fill me-2"></i>Ver Telefone
                        </button>
                        <button class="btn btn-outline-primary btn-lg">
                            <i class="bi bi-chat-dots-fill me-2"></i>Enviar Mensagem
                        </button>
                    </div>
                </div>
                <div class="card-footer text-center bg-light">
                    <a href="#" class="text-primary text-decoration-none fw-semibold">
                        <i class="bi bi-grid-3x3-gap me-1"></i>Ver todos os anúncios
                    </a>
                </div>
            </div>

            <!-- Safety Tips Card -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-warning bg-opacity-10 border-warning">
                    <h6 class="mb-0 text-warning"><i class="bi bi-shield-exclamation me-2"></i>Dicas de Segurança</h6>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled safety-tips mb-0 small">
                        <li class="mb-2"><i class="bi bi-check2 text-success me-2"></i>Inspeccione o veículo pessoalmente</li>
                        <li class="mb-2"><i class="bi bi-check2 text-success me-2"></i>Verifique a documentação</li>
                        <li class="mb-2"><i class="bi bi-check2 text-success me-2"></i>Não efetue pagamentos antecipados</li>
                        <li class="mb-0"><i class="bi bi-check2 text-success me-2"></i>Teste o carro antes de comprar</li>
                    </ul>
                </div>
            </div>

            <!-- Report Card -->
            <div class="card shadow-sm">
                <div class="card-body text-center">
                    <button class="btn btn-link text-danger text-decoration-none p-0">
                        <i class="bi bi-flag-fill me-1"></i>Denunciar este anúncio
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Anúncios Relacionados -->
    <section class="related-listings-section mt-5 pt-4 border-top">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3><i class="bi bi-grid-3x3-gap-fill me-2"></i>Anúncios Semelhantes</h3>
                <a href="/Anuncios" class="btn btn-outline-primary">Ver mais</a>
            </div>
            <div class="row g-4">
                <!-- Related Card 1 -->
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 shadow-sm related-card">
                        <div class="card-img-wrapper-related">
                            <img src="~/imagens/audiA3.jpg" class="card-img-top" alt="Audi A3">
                            <button class="btn-favorito-small" onclick="toggleFavoritoDetails(this)">
                                <i class="bi bi-heart"></i>
                            </button>
                        </div>
                        <div class="card-body">
                            <h6 class="card-title mb-2">Audi A3 Sportback 2.0 TDI</h6>
                            <p class="text-primary fw-bold fs-5 mb-2">22.900 €</p>
                            <div class="small text-muted mb-2">
                                <i class="bi bi-calendar3 me-1"></i>2018 • <i class="bi bi-speedometer2 me-1"></i>115.000 km
                            </div>
                            <div class="small text-muted">
                                <i class="bi bi-geo-alt-fill me-1"></i>Lisboa
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Related Card 2 -->
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 shadow-sm related-card">
                        <div class="card-img-wrapper-related">
                            <img src="~/imagens/mercedesBenz.jpg" class="card-img-top" alt="Mercedes">
                            <button class="btn-favorito-small" onclick="toggleFavoritoDetails(this)">
                                <i class="bi bi-heart"></i>
                            </button>
                        </div>
                        <div class="card-body">
                            <h6 class="card-title mb-2">Mercedes-Benz Classe C 220d</h6>
                            <p class="text-primary fw-bold fs-5 mb-2">31.500 €</p>
                            <div class="small text-muted mb-2">
                                <i class="bi bi-calendar3 me-1"></i>2020 • <i class="bi bi-speedometer2 me-1"></i>75.000 km
                            </div>
                            <div class="small text-muted">
                                <i class="bi bi-geo-alt-fill me-1"></i>Porto
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Related Card 3 -->
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 shadow-sm related-card">
                        <div class="card-img-wrapper-related">
                            <img src="~/imagens/bmwSerie1.jpg" class="card-img-top" alt="BMW">
                            <button class="btn-favorito-small" onclick="toggleFavoritoDetails(this)">
                                <i class="bi bi-heart"></i>
                            </button>
                        </div>
                        <div class="card-body">
                            <h6 class="card-title mb-2">BMW 320d Efficient Dynamics</h6>
                            <p class="text-primary fw-bold fs-5 mb-2">26.200 €</p>
                            <div class="small text-muted mb-2">
                                <i class="bi bi-calendar3 me-1"></i>2019 • <i class="bi bi-speedometer2 me-1"></i>92.000 km
                            </div>
                            <div class="small text-muted">
                                <i class="bi bi-geo-alt-fill me-1"></i>Coimbra
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Related Card 4 -->
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 shadow-sm related-card">
                        <div class="card-img-wrapper-related">
                            <img src="https://placehold.co/400x300/343a40/e9ecef?text=Volvo" class="card-img-top" alt="Volvo">
                            <button class="btn-favorito-small" onclick="toggleFavoritoDetails(this)">
                                <i class="bi bi-heart"></i>
                            </button>
                        </div>
                        <div class="card-body">
                            <h6 class="card-title mb-2">Volvo V60 D4 Momentum</h6>
                            <p class="text-primary fw-bold fs-5 mb-2">29.800 €</p>
                            <div class="small text-muted mb-2">
                                <i class="bi bi-calendar3 me-1"></i>2019 • <i class="bi bi-speedometer2 me-1"></i>85.000 km
                            </div>
                            <div class="small text-muted">
                                <i class="bi bi-geo-alt-fill me-1"></i>Braga
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<script>
    // Gallery Thumbnails Navigation
    function goToSlide(index) {
        const carousel = document.querySelector('#galleryCarousel');
        const bsCarousel = bootstrap.Carousel.getInstance(carousel) || new bootstrap.Carousel(carousel);
        bsCarousel.to(index);

        // Update active thumbnail
        document.querySelectorAll('.thumbnail-item').forEach((thumb, i) => {
            thumb.classList.toggle('active', i === index);
        });
    }

    // Update active thumbnail when carousel slides
    document.querySelector('#galleryCarousel').addEventListener('slid.bs.carousel', function (e) {
        const activeIndex = Array.from(e.target.querySelectorAll('.carousel-item')).indexOf(e.relatedTarget);
        document.querySelectorAll('.thumbnail-item').forEach((thumb, i) => {
            thumb.classList.toggle('active', i === activeIndex);
        });
    });

    // Fullscreen Gallery (placeholder - would need modal implementation)
    function openFullscreen(index) {
        alert('Funcionalidade de galeria em ecrã completo - imagem ' + (index + 1));
        // In production, this would open a modal with larger images
    }

    // Toggle Favorite
    function toggleFavoritoDetails(button) {
        const icon = button.querySelector('i');
        if (icon.classList.contains('bi-heart')) {
            icon.classList.remove('bi-heart');
            icon.classList.add('bi-heart-fill');
            button.classList.add('active');
        } else {
            icon.classList.remove('bi-heart-fill');
            icon.classList.add('bi-heart');
            button.classList.remove('active');
        }
    }
</script>
