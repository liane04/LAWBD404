@{
    ViewData["Title"] = "Detalhes do Anúncio";
}

<!-- Breadcrumb Navigation -->
<nav aria-label="breadcrumb" class="bg-light border-bottom">
    <div class="container">
        <ol class="breadcrumb py-3 mb-0">
            <li class="breadcrumb-item"><a href="/"><i class="bi bi-house-door-fill me-1"></i>Início</a></li>
            <li class="breadcrumb-item"><a href="/Anuncios">Anúncios</a></li>
            <li class="breadcrumb-item active" aria-current="page">BMW Série 3 320d</li>
        </ol>
    </div>
</nav>

<div class="container my-5">
    <div class="row">
        <!-- Coluna Principal: Imagens e Detalhes -->
        <div class="col-lg-8">
            <!-- Título e Preço -->
            <div class="mb-4">
                <div class="d-flex align-items-start justify-content-between mb-3">
                    <div>
                        <h1 class="h2 mb-2">BMW Série 3 320d Pack M</h1>
                        <div class="d-flex gap-2 flex-wrap">
                            <span class="badge bg-success"><i class="bi bi-check-circle-fill me-1"></i>Verificado</span>
                            <span class="badge bg-primary"><i class="bi bi-star-fill me-1"></i>Destaque</span>
                            <span class="badge bg-info text-dark"><i class="bi bi-clock-fill me-1"></i>Publicado há 2 dias</span>
                        </div>
                    </div>
                    <div class="d-flex gap-2">
                        <button class="btn btn-outline-secondary" title="Partilhar" data-bs-toggle="dropdown">
                            <i class="bi bi-share-fill"></i>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#"><i class="bi bi-facebook me-2 text-primary"></i>Facebook</a></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-whatsapp me-2 text-success"></i>WhatsApp</a></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-envelope-fill me-2 text-danger"></i>Email</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-link-45deg me-2"></i>Copiar Link</a></li>
                        </ul>
                        <button class="btn btn-outline-danger" onclick="toggleFavoritoDetails(this)" title="Adicionar aos Favoritos">
                            <i class="bi bi-heart"></i>
                        </button>
                    </div>
                </div>
                <div class="price-section p-3 bg-light rounded-3 border">
                    <div class="d-flex align-items-center justify-content-between">
                        <div>
                            <p class="text-muted mb-1 small">Preço:</p>
                            <h2 class="text-primary fw-bold mb-0">28.500 €</h2>
                        </div>
                        <div class="text-end">
                            <p class="text-muted mb-1 small">Valor estimado:</p>
                            <p class="mb-0 fw-semibold text-success"><i class="bi bi-graph-up-arrow me-1"></i>Bom negócio</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Galeria de Imagens (Carrossel) -->
            <div class="gallery-container mb-4">
                <div id="galleryCarousel" class="carousel slide shadow-lg rounded-3 overflow-hidden" data-bs-ride="carousel">
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <img src="~/imagens/bmwSerie1.jpg" class="d-block w-100 gallery-main-image" alt="Frente do carro" onclick="openFullscreen(0)">
                        </div>
                        <div class="carousel-item">
                            <img src="https://placehold.co/800x600/343a40/e9ecef?text=Interior" class="d-block w-100 gallery-main-image" alt="Interior do carro" onclick="openFullscreen(1)">
                        </div>
                        <div class="carousel-item">
                            <img src="https://placehold.co/800x600/343a40/e9ecef?text=Traseira" class="d-block w-100 gallery-main-image" alt="Traseira do carro" onclick="openFullscreen(2)">
                        </div>
                        <div class="carousel-item">
                            <img src="https://placehold.co/800x600/343a40/e9ecef?text=Lateral" class="d-block w-100 gallery-main-image" alt="Lateral do carro" onclick="openFullscreen(3)">
                        </div>
                        <div class="carousel-item">
                            <img src="https://placehold.co/800x600/343a40/e9ecef?text=Painel" class="d-block w-100 gallery-main-image" alt="Painel do carro" onclick="openFullscreen(4)">
                        </div>
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#galleryCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Anterior</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#galleryCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Seguinte</span>
                    </button>
                    <button class="btn btn-light btn-fullscreen" onclick="openFullscreen(0)">
                        <i class="bi bi-arrows-fullscreen"></i>
                    </button>
                </div>

                <!-- Miniaturas -->
                <div class="gallery-thumbnails mt-3">
                    <div class="thumbnail-item active" onclick="goToSlide(0)">
                        <img src="~/imagens/bmwSerie1.jpg" alt="Thumb 1">
                    </div>
                    <div class="thumbnail-item" onclick="goToSlide(1)">
                        <img src="https://placehold.co/150x100/343a40/e9ecef?text=Interior" alt="Thumb 2">
                    </div>
                    <div class="thumbnail-item" onclick="goToSlide(2)">
                        <img src="https://placehold.co/150x100/343a40/e9ecef?text=Traseira" alt="Thumb 3">
                    </div>
                    <div class="thumbnail-item" onclick="goToSlide(3)">
                        <img src="https://placehold.co/150x100/343a40/e9ecef?text=Lateral" alt="Thumb 4">
                    </div>
                    <div class="thumbnail-item" onclick="goToSlide(4)">
                        <img src="https://placehold.co/150x100/343a40/e9ecef?text=Painel" alt="Thumb 5">
                    </div>
                    <div class="thumbnail-item view-all">
                        <i class="bi bi-grid-3x3-gap-fill"></i>
                        <span>Ver todas (5)</span>
                    </div>
                </div>
            </div>

            <!-- Detalhes Rápidos -->
            <div class="card shadow-sm mb-4">
                <div class="card-body anuncio-details-grid-details-page">
                    <span><i class="bi bi-calendar3"></i> 2019</span>
                    <span><i class="bi bi-speedometer2"></i> 98.000 km</span>
                    <span><i class="bi bi-fuel-pump-fill"></i> Diesel</span>
                    <span><i class="bi bi-gear-fill"></i> Manual</span>
                    <span><i class="bi bi-palette-fill"></i> Cinzento</span>
                    <span><i class="bi bi-person-check-fill"></i> Particular</span>
                </div>
            </div>


            <!-- Descrição -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0"><i class="bi bi-file-text-fill me-2"></i>Descrição</h4>
                </div>
                <div class="card-body">
                    <p class="mb-2">Carro nacional em excelente estado, com todas as revisões na marca. Pack M completo, interior e exterior. Viatura muito estimada e com um consumo médio de 5L/100km. Não fumador.</p>
                    <p class="mb-0">Equipado com GPS profissional, bancos desportivos em alcântara, jantes de 18 polegadas, faróis LED e sensores de estacionamento à frente e atrás.</p>
                </div>
            </div>

            <!-- Especificações Técnicas -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0"><i class="bi bi-gear-wide-connected me-2"></i>Especificações Técnicas</h4>
                </div>
                <div class="card-body p-0">
                    <div class="specifications-grid">
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-building"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Marca</span>
                                <span class="spec-value">BMW</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-car-front"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Modelo</span>
                                <span class="spec-value">Série 3</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-calendar3"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Ano</span>
                                <span class="spec-value">2019</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-speedometer2"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Quilómetros</span>
                                <span class="spec-value">98.000 km</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-fuel-pump-fill"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Combustível</span>
                                <span class="spec-value">Diesel</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-gear-fill"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Caixa</span>
                                <span class="spec-value">Manual</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-lightning-charge-fill"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Potência</span>
                                <span class="spec-value">190 cv</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-speedometer"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Cilindrada</span>
                                <span class="spec-value">1995 cm³</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-palette-fill"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Cor</span>
                                <span class="spec-value">Cinzento</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-door-closed-fill"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Portas</span>
                                <span class="spec-value">4</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-people-fill"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Lugares</span>
                                <span class="spec-value">5</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon"><i class="bi bi-shield-fill-check"></i></div>
                            <div class="spec-content">
                                <span class="spec-label">Estado</span>
                                <span class="spec-value">Usado</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Extras e Equipamentos -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0"><i class="bi bi-star-fill me-2"></i>Extras e Equipamentos</h4>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3"><i class="bi bi-shield-check me-2"></i>Segurança</h6>
                            <ul class="list-unstyled extras-list">
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>ABS</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Airbags (6)</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Controlo de Estabilidade</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Sensores Estacionamento</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Câmara Traseira</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3"><i class="bi bi-lightning-charge me-2"></i>Conforto</h6>
                            <ul class="list-unstyled extras-list">
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Ar Condicionado Automático</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Bancos em Pele/Alcântara</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Bancos Aquecidos</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Volante Multifunções</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Cruise Control</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3"><i class="bi bi-speaker me-2"></i>Multimédia</h6>
                            <ul class="list-unstyled extras-list">
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Sistema Navegação GPS</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Bluetooth</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Ecrã Tátil</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>USB/AUX</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3"><i class="bi bi-tools me-2"></i>Outros</h6>
                            <ul class="list-unstyled extras-list">
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Jantes Liga Leve 18"</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Faróis LED</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Pack M Sport</li>
                                <li><i class="bi bi-check-circle-fill text-success me-2"></i>Vidros Escurecidos</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Coluna Lateral: Vendedor e Contacto -->
        <div class="col-lg-4">
            <!-- Seller Card -->
            <div class="seller-card card shadow-sm sticky-top mb-4">
                <div class="card-body text-center">
                    <div class="position-relative d-inline-block mb-3">
                        <img src="https://placehold.co/100x100/0d6efd/ffffff?text=User" class="rounded-circle seller-avatar" alt="Foto do Vendedor">
                        <span class="badge-verified"><i class="bi bi-patch-check-fill"></i></span>
                    </div>
                    <h5 class="card-title mb-1">Pedro Costa</h5>
                    <p class="text-muted mb-2">Membro desde 2021</p>

                    <!-- Rating -->
                    <div class="seller-rating mb-3">
                        <div class="stars mb-1">
                            <i class="bi bi-star-fill text-warning"></i>
                            <i class="bi bi-star-fill text-warning"></i>
                            <i class="bi bi-star-fill text-warning"></i>
                            <i class="bi bi-star-fill text-warning"></i>
                            <i class="bi bi-star-half text-warning"></i>
                        </div>
                        <small class="text-muted">4.5 (28 avaliações)</small>
                    </div>

                    <!-- Seller Stats -->
                    <div class="seller-stats mb-3">
                        <div class="row text-center g-2">
                            <div class="col-6">
                                <div class="stat-box p-2 bg-light rounded">
                                    <div class="stat-number text-primary fw-bold">12</div>
                                    <div class="stat-label small text-muted">Anúncios</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="stat-box p-2 bg-light rounded">
                                    <div class="stat-number text-success fw-bold">98%</div>
                                    <div class="stat-label small text-muted">Resposta</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-lg">
                            <i class="bi bi-telephone-fill me-2"></i>Ver Telefone
                        </button>
                        <button class="btn btn-outline-primary btn-lg">
                            <i class="bi bi-chat-dots-fill me-2"></i>Enviar Mensagem
                        </button>

                        <hr class="my-2">

                        <button class="btn btn-success btn-lg" data-bs-toggle="modal" data-bs-target="#reservarModal" data-mockup-user-type="comprador">
                            <i class="bi bi-bookmark-check-fill me-2"></i>Reservar Veículo
                        </button>
                        <button class="btn btn-info btn-lg text-white" data-bs-toggle="modal" data-bs-target="#agendarVisitaModal" data-mockup-user-type="comprador">
                            <i class="bi bi-calendar-check-fill me-2"></i>Agendar Visita
                        </button>
                    </div>
                </div>
                <div class="card-footer text-center bg-light">
                    <a href="#" class="text-primary text-decoration-none fw-semibold">
                        <i class="bi bi-grid-3x3-gap me-1"></i>Ver todos os anúncios
                    </a>
                </div>
            </div>

            <!-- Safety Tips Card -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-warning bg-opacity-10 border-warning">
                    <h6 class="mb-0 text-warning"><i class="bi bi-shield-exclamation me-2"></i>Dicas de Segurança</h6>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled safety-tips mb-0 small">
                        <li class="mb-2"><i class="bi bi-check2 text-success me-2"></i>Inspeccione o veículo pessoalmente</li>
                        <li class="mb-2"><i class="bi bi-check2 text-success me-2"></i>Verifique a documentação</li>
                        <li class="mb-2"><i class="bi bi-check2 text-success me-2"></i>Não efetue pagamentos antecipados</li>
                        <li class="mb-0"><i class="bi bi-check2 text-success me-2"></i>Teste o carro antes de comprar</li>
                    </ul>
                </div>
            </div>

            <!-- Report Card -->
            <div class="card shadow-sm">
                <div class="card-body text-center">
                    <button class="btn btn-link text-danger text-decoration-none p-0">
                        <i class="bi bi-flag-fill me-1"></i>Denunciar este anúncio
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Anúncios Relacionados -->
    <section class="related-listings-section mt-5 pt-4 border-top">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3><i class="bi bi-grid-3x3-gap-fill me-2"></i>Anúncios Semelhantes</h3>
                <a href="/Anuncios" class="btn btn-outline-primary">Ver mais</a>
            </div>
            <div class="row g-4">
                <!-- Related Card 1 -->
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 shadow-sm related-card">
                        <div class="card-img-wrapper-related">
                            <img src="~/imagens/audiA3.jpg" class="card-img-top" alt="Audi A3">
                            <button class="btn-favorito-small" onclick="toggleFavoritoDetails(this)">
                                <i class="bi bi-heart"></i>
                            </button>
                        </div>
                        <div class="card-body">
                            <h6 class="card-title mb-2">Audi A3 Sportback 2.0 TDI</h6>
                            <p class="text-primary fw-bold fs-5 mb-2">22.900 €</p>
                            <div class="small text-muted mb-2">
                                <i class="bi bi-calendar3 me-1"></i>2018 • <i class="bi bi-speedometer2 me-1"></i>115.000 km
                            </div>
                            <div class="small text-muted">
                                <i class="bi bi-geo-alt-fill me-1"></i>Lisboa
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Related Card 2 -->
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 shadow-sm related-card">
                        <div class="card-img-wrapper-related">
                            <img src="~/imagens/mercedesBenz.jpg" class="card-img-top" alt="Mercedes">
                            <button class="btn-favorito-small" onclick="toggleFavoritoDetails(this)">
                                <i class="bi bi-heart"></i>
                            </button>
                        </div>
                        <div class="card-body">
                            <h6 class="card-title mb-2">Mercedes-Benz Classe C 220d</h6>
                            <p class="text-primary fw-bold fs-5 mb-2">31.500 €</p>
                            <div class="small text-muted mb-2">
                                <i class="bi bi-calendar3 me-1"></i>2020 • <i class="bi bi-speedometer2 me-1"></i>75.000 km
                            </div>
                            <div class="small text-muted">
                                <i class="bi bi-geo-alt-fill me-1"></i>Porto
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Related Card 3 -->
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 shadow-sm related-card">
                        <div class="card-img-wrapper-related">
                            <img src="~/imagens/bmwSerie1.jpg" class="card-img-top" alt="BMW">
                            <button class="btn-favorito-small" onclick="toggleFavoritoDetails(this)">
                                <i class="bi bi-heart"></i>
                            </button>
                        </div>
                        <div class="card-body">
                            <h6 class="card-title mb-2">BMW 320d Efficient Dynamics</h6>
                            <p class="text-primary fw-bold fs-5 mb-2">26.200 €</p>
                            <div class="small text-muted mb-2">
                                <i class="bi bi-calendar3 me-1"></i>2019 • <i class="bi bi-speedometer2 me-1"></i>92.000 km
                            </div>
                            <div class="small text-muted">
                                <i class="bi bi-geo-alt-fill me-1"></i>Coimbra
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Related Card 4 -->
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 shadow-sm related-card">
                        <div class="card-img-wrapper-related">
                            <img src="~/imagens/Jeep_mercedes.png" class="card-img-top" alt="Mercedes G-Class">
                            <button class="btn-favorito-small" onclick="toggleFavoritoDetails(this)">
                                <i class="bi bi-heart"></i>
                            </button>
                        </div>
                        <div class="card-body">
                            <h6 class="card-title mb-2">Mercedes-Benz G 350d AMG</h6>
                            <p class="text-primary fw-bold fs-5 mb-2">89.900 €</p>
                            <div class="small text-muted mb-2">
                                <i class="bi bi-calendar3 me-1"></i>2020 • <i class="bi bi-speedometer2 me-1"></i>65.000 km
                            </div>
                            <div class="small text-muted">
                                <i class="bi bi-geo-alt-fill me-1"></i>Lisboa
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- Modal: Reservar Veículo -->
<div class="modal fade" id="reservarModal" tabindex="-1" aria-labelledby="reservarModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-success bg-opacity-10 border-success">
                <h5 class="modal-title fw-bold text-success" id="reservarModalLabel">
                    <i class="bi bi-bookmark-check-fill me-2"></i>Reservar Veículo
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <!-- Informações do Veículo -->
                <div class="alert alert-info border-info d-flex align-items-start mb-4">
                    <i class="bi bi-info-circle-fill me-3 fs-4 flex-shrink-0"></i>
                    <div>
                        <h6 class="alert-heading fw-bold mb-2">Como funciona a reserva?</h6>
                        <p class="mb-2 small">
                            Ao reservar este veículo, você garante a prioridade na compra por <strong>48 horas</strong>.
                            Durante este período, o anúncio ficará marcado como "Reservado" e outros compradores não poderão reservá-lo.
                        </p>
                        <p class="mb-0 small">
                            <strong>Sinal:</strong> Para garantir a reserva, é necessário efetuar um pagamento de <strong class="text-primary">500€</strong> (sinal definido pelo vendedor).
                            Este valor será descontado no preço final do veículo. Em caso de desistência da compra, o sinal não é reembolsável.
                        </p>
                    </div>
                </div>

                <!-- Resumo do Veículo -->
                <div class="card bg-light border-0 mb-4">
                    <div class="card-body">
                        <h6 class="fw-bold mb-3">
                            <i class="bi bi-car-front-fill text-primary me-2"></i>Veículo a Reservar
                        </h6>
                        <div class="row g-3">
                            <div class="col-auto">
                                <img src="~/imagens/bmwSerie1.jpg" alt="BMW Série 3" class="rounded" style="width: 100px; height: 75px; object-fit: cover;">
                            </div>
                            <div class="col">
                                <h5 class="mb-1">BMW Série 3 320d Pack M</h5>
                                <p class="text-muted mb-1 small">2019 • 85.000 km • Diesel • Manual</p>
                                <div class="d-flex justify-content-between align-items-center mt-2">
                                    <div>
                                        <p class="text-muted mb-0 small">Preço Total:</p>
                                        <p class="text-success fw-bold fs-5 mb-0">28.500 €</p>
                                    </div>
                                    <div class="text-end">
                                        <p class="text-muted mb-0 small">Sinal a Pagar:</p>
                                        <p class="text-primary fw-bold fs-5 mb-0">500 €</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Formulário de Reserva -->
                <form id="formReserva">
                    <h6 class="fw-bold mb-3">
                        <i class="bi bi-person-fill text-primary me-2"></i>Seus Dados
                    </h6>

                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <label for="reservaNome" class="form-label">Nome Completo <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="reservaNome" value="João Duarte Silva" required>
                        </div>
                        <div class="col-md-6">
                            <label for="reservaEmail" class="form-label">Email <span class="text-danger">*</span></label>
                            <input type="email" class="form-control" id="reservaEmail" value="joao.silva@exemplo.com" required>
                        </div>
                        <div class="col-md-6">
                            <label for="reservaTelefone" class="form-label">Telefone <span class="text-danger">*</span></label>
                            <input type="tel" class="form-control" id="reservaTelefone" value="+351 912 345 678" required>
                        </div>
                        <div class="col-md-6">
                            <label for="reservaDataExpiracao" class="form-label">Validade da Reserva</label>
                            <input type="text" class="form-control" id="reservaDataExpiracao" value="48 horas" readonly>
                        </div>
                    </div>

                    <h6 class="fw-bold mb-3">
                        <i class="bi bi-credit-card text-primary me-2"></i>Pagamento do Sinal
                    </h6>
                    <div class="mb-4">
                        <div class="row g-3">
                            <div class="col-md-12">
                                <label for="metodoPagamento" class="form-label">Método de Pagamento <span class="text-danger">*</span></label>
                                <select class="form-select" id="metodoPagamento" required>
                                    <option value="">Selecione o método...</option>
                                    <option value="mbway">MB WAY</option>
                                    <option value="transferencia">Transferência Bancária</option>
                                    <option value="multibanco">Multibanco (Referência MB)</option>
                                    <option value="cartao">Cartão de Crédito/Débito</option>
                                </select>
                                <div class="form-text">O sinal de 500€ será processado após a confirmação do vendedor</div>
                            </div>
                        </div>
                    </div>

                    <h6 class="fw-bold mb-3">
                        <i class="bi bi-chat-text text-primary me-2"></i>Mensagem (Opcional)
                    </h6>
                    <div class="mb-4">
                        <textarea class="form-control" id="reservaMensagem" rows="3" placeholder="Deixe uma mensagem para o vendedor (ex: disponibilidade para visita, questões sobre o veículo...)"></textarea>
                        <div class="form-text">Esta mensagem será enviada ao vendedor junto com a notificação de reserva.</div>
                    </div>

                    <!-- Termos e Condições -->
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="reservaTermos" required>
                        <label class="form-check-label small" for="reservaTermos">
                            Li e concordo com os <a href="#" class="text-primary">termos e condições de reserva</a>
                        </label>
                    </div>

                    <!-- Timeline da Reserva -->
                    <div class="alert alert-light border mb-0">
                        <h6 class="fw-bold mb-3">O que acontece a seguir?</h6>
                        <div class="d-flex mb-2">
                            <div class="flex-shrink-0 me-3">
                                <div class="rounded-circle bg-success text-white d-flex align-items-center justify-content-center" style="width: 32px; height: 32px;">
                                    <i class="bi bi-1-circle-fill"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="mb-1 small fw-semibold">Confirmação Imediata</h6>
                                <p class="mb-0 small text-muted">Receberá um email de confirmação com os detalhes da reserva</p>
                            </div>
                        </div>
                        <div class="d-flex mb-2">
                            <div class="flex-shrink-0 me-3">
                                <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center" style="width: 32px; height: 32px;">
                                    <i class="bi bi-2-circle-fill"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="mb-1 small fw-semibold">Contacto do Vendedor</h6>
                                <p class="mb-0 small text-muted">O vendedor irá contactá-lo para agendar uma visita</p>
                            </div>
                        </div>
                        <div class="d-flex">
                            <div class="flex-shrink-0 me-3">
                                <div class="rounded-circle bg-info text-white d-flex align-items-center justify-content-center" style="width: 32px; height: 32px;">
                                    <i class="bi bi-3-circle-fill"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="mb-1 small fw-semibold">Prioridade Garantida</h6>
                                <p class="mb-0 small text-muted">Tem 48h para decidir sobre a compra com prioridade exclusiva</p>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer border-0 bg-light">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-circle me-1"></i>Cancelar
                </button>
                <button type="button" class="btn btn-success" id="btnConfirmarReserva">
                    <i class="bi bi-bookmark-check-fill me-2"></i>Confirmar Reserva
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal: Agendar Visita -->
<div class="modal fade" id="agendarVisitaModal" tabindex="-1" aria-labelledby="agendarVisitaModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-info bg-opacity-10 border-info">
                <h5 class="modal-title fw-bold text-info" id="agendarVisitaModalLabel">
                    <i class="bi bi-calendar-check-fill me-2"></i>Agendar Visita
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <!-- Informações -->
                <div class="alert alert-info border-info d-flex align-items-start mb-4">
                    <i class="bi bi-info-circle-fill me-3 fs-4 flex-shrink-0"></i>
                    <div>
                        <h6 class="alert-heading fw-bold mb-2">Agende uma visita presencial</h6>
                        <p class="mb-2 small">
                            Marque uma data e hora para ver o veículo pessoalmente. O vendedor irá confirmar a disponibilidade e enviará os detalhes do local.
                        </p>
                        <p class="mb-0 small">
                            <strong>Dica:</strong> Aproveite a visita para fazer um test-drive e verificar toda a documentação do veículo.
                        </p>
                    </div>
                </div>

                <!-- Resumo do Veículo -->
                <div class="card bg-light border-0 mb-4">
                    <div class="card-body">
                        <h6 class="fw-bold mb-3">
                            <i class="bi bi-car-front-fill text-primary me-2"></i>Veículo
                        </h6>
                        <div class="row g-3">
                            <div class="col-auto">
                                <img src="~/imagens/bmwSerie1.jpg" alt="BMW Série 3" class="rounded" style="width: 100px; height: 75px; object-fit: cover;">
                            </div>
                            <div class="col">
                                <h5 class="mb-1">BMW Série 3 320d Pack M</h5>
                                <p class="text-muted mb-1 small">2019 • 85.000 km • Diesel • Manual</p>
                                <p class="text-success fw-bold fs-5 mb-0">28.500 €</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Informações do Vendedor -->
                <div class="card bg-light border-0 mb-4">
                    <div class="card-body">
                        <h6 class="fw-bold mb-3">
                            <i class="bi bi-person-badge text-primary me-2"></i>Vendedor
                        </h6>
                        <div class="d-flex align-items-center">
                            <img src="https://placehold.co/60x60/0d6efd/ffffff?text=PC" class="rounded-circle me-3" alt="Pedro Costa">
                            <div>
                                <h6 class="mb-1">Pedro Costa</h6>
                                <p class="text-muted mb-0 small">
                                    <i class="bi bi-star-fill text-warning me-1"></i>4.5 (28 avaliações) •
                                    <i class="bi bi-geo-alt-fill text-primary me-1"></i>Porto
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Formulário de Agendamento -->
                <form id="formAgendarVisita">
                    <h6 class="fw-bold mb-3">
                        <i class="bi bi-calendar2-week text-primary me-2"></i>Data e Hora Preferencial
                    </h6>

                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <label for="visitaData" class="form-label">Data da Visita <span class="text-danger">*</span></label>
                            <input type="date" class="form-control" id="visitaData" required>
                            <div class="form-text">Escolha uma data nos próximos 14 dias</div>
                        </div>
                        <div class="col-md-6">
                            <label for="visitaHora" class="form-label">Hora Preferencial <span class="text-danger">*</span></label>
                            <select class="form-select" id="visitaHora" required>
                                <option value="">Selecione...</option>
                                <option value="09:00">09:00</option>
                                <option value="10:00">10:00</option>
                                <option value="11:00">11:00</option>
                                <option value="12:00">12:00</option>
                                <option value="14:00">14:00</option>
                                <option value="15:00">15:00</option>
                                <option value="16:00">16:00</option>
                                <option value="17:00">17:00</option>
                                <option value="18:00">18:00</option>
                            </select>
                            <div class="form-text">O vendedor irá confirmar a disponibilidade</div>
                        </div>
                    </div>

                    <h6 class="fw-bold mb-3">
                        <i class="bi bi-person-fill text-primary me-2"></i>Seus Dados
                    </h6>

                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <label for="visitaNome" class="form-label">Nome Completo <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="visitaNome" value="João Duarte Silva" required>
                        </div>
                        <div class="col-md-6">
                            <label for="visitaEmail" class="form-label">Email <span class="text-danger">*</span></label>
                            <input type="email" class="form-control" id="visitaEmail" value="joao.silva@exemplo.com" required>
                        </div>
                        <div class="col-md-6">
                            <label for="visitaTelefone" class="form-label">Telefone <span class="text-danger">*</span></label>
                            <input type="tel" class="form-control" id="visitaTelefone" value="+351 912 345 678" required>
                        </div>
                        <div class="col-md-6">
                            <label for="visitaNumPessoas" class="form-label">Número de Acompanhantes</label>
                            <select class="form-select" id="visitaNumPessoas">
                                <option value="0" selected>Apenas eu</option>
                                <option value="1">1 acompanhante</option>
                                <option value="2">2 acompanhantes</option>
                                <option value="3">3+ acompanhantes</option>
                            </select>
                        </div>
                    </div>

                    <!-- Interesses Específicos -->
                    <h6 class="fw-bold mb-3">
                        <i class="bi bi-list-check text-primary me-2"></i>Interesses Durante a Visita (Opcional)
                    </h6>
                    <div class="row g-2 mb-4">
                        <div class="col-md-6">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="checkTestDrive" checked>
                                <label class="form-check-label" for="checkTestDrive">
                                    <i class="bi bi-speedometer2 me-1"></i>Test Drive
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="checkDocumentacao" checked>
                                <label class="form-check-label" for="checkDocumentacao">
                                    <i class="bi bi-file-earmark-text me-1"></i>Verificar Documentação
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="checkInspecao">
                                <label class="form-check-label" for="checkInspecao">
                                    <i class="bi bi-tools me-1"></i>Inspeção Mecânica
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="checkFinanciamento">
                                <label class="form-check-label" for="checkFinanciamento">
                                    <i class="bi bi-cash-coin me-1"></i>Discutir Financiamento
                                </label>
                            </div>
                        </div>
                    </div>

                    <h6 class="fw-bold mb-3">
                        <i class="bi bi-chat-text text-primary me-2"></i>Observações (Opcional)
                    </h6>
                    <div class="mb-4">
                        <textarea class="form-control" id="visitaObservacoes" rows="3" placeholder="Questões específicas, aspetos que gostaria de ver, ou outras observações..."></textarea>
                    </div>

                    <!-- Confirmação -->
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="visitaConfirmacao" required>
                        <label class="form-check-label small" for="visitaConfirmacao">
                            Compreendo que esta visita está sujeita à confirmação do vendedor
                        </label>
                    </div>

                    <!-- Info Adicional -->
                    <div class="alert alert-light border mb-0">
                        <h6 class="fw-bold mb-2 small">
                            <i class="bi bi-shield-check me-1"></i>Dicas de Segurança para a Visita
                        </h6>
                        <ul class="mb-0 small text-muted">
                            <li>Marque a visita num local público e durante o dia</li>
                            <li>Leve um acompanhante, se possível</li>
                            <li>Verifique toda a documentação do veículo</li>
                            <li>Não efetue pagamentos durante a visita</li>
                        </ul>
                    </div>
                </form>
            </div>
            <div class="modal-footer border-0 bg-light">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-circle me-1"></i>Cancelar
                </button>
                <button type="button" class="btn btn-info text-white" id="btnConfirmarVisita">
                    <i class="bi bi-calendar-check-fill me-2"></i>Confirmar Agendamento
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    // Gallery Thumbnails Navigation
    function goToSlide(index) {
        const carousel = document.querySelector('#galleryCarousel');
        const bsCarousel = bootstrap.Carousel.getInstance(carousel) || new bootstrap.Carousel(carousel);
        bsCarousel.to(index);

        // Update active thumbnail
        document.querySelectorAll('.thumbnail-item').forEach((thumb, i) => {
            thumb.classList.toggle('active', i === index);
        });
    }

    // Update active thumbnail when carousel slides
    document.querySelector('#galleryCarousel').addEventListener('slid.bs.carousel', function (e) {
        const activeIndex = Array.from(e.target.querySelectorAll('.carousel-item')).indexOf(e.relatedTarget);
        document.querySelectorAll('.thumbnail-item').forEach((thumb, i) => {
            thumb.classList.toggle('active', i === activeIndex);
        });
    });

    // Fullscreen Gallery (placeholder - would need modal implementation)
    function openFullscreen(index) {
        alert('Funcionalidade de galeria em ecrã completo - imagem ' + (index + 1));
        // In production, this would open a modal with larger images
    }

    // Toggle Favorite
    function toggleFavoritoDetails(button) {
        const icon = button.querySelector('i');
        if (icon.classList.contains('bi-heart')) {
            icon.classList.remove('bi-heart');
            icon.classList.add('bi-heart-fill');
            button.classList.add('active');
        } else {
            icon.classList.remove('bi-heart-fill');
            icon.classList.add('bi-heart');
            button.classList.remove('active');
        }
    }

    // Mockup: Confirmar Reserva
    document.addEventListener('DOMContentLoaded', function () {
        const btnConfirmarReserva = document.getElementById('btnConfirmarReserva');
        const btnConfirmarVisita = document.getElementById('btnConfirmarVisita');
        const reservarModal = document.getElementById('reservarModal');
        const agendarVisitaModal = document.getElementById('agendarVisitaModal');

        // Confirmar Reserva
        if (btnConfirmarReserva) {
            btnConfirmarReserva.addEventListener('click', function () {
                // Validação básica do formulário
                const form = document.getElementById('formReserva');
                const termosCheckbox = document.getElementById('reservaTermos');
                const metodoPagamento = document.getElementById('metodoPagamento').value;

                if (!metodoPagamento) {
                    alert('Por favor, selecione um método de pagamento.');
                    return;
                }

                if (!termosCheckbox.checked) {
                    alert('Por favor, aceite os termos e condições para continuar.');
                    return;
                }

                // Simular sucesso
                const modalInstance = bootstrap.Modal.getInstance(reservarModal);
                modalInstance.hide();

                // Mostrar mensagem de sucesso
                setTimeout(() => {
                    mostrarMensagemSucesso(
                        'Reserva Confirmada!',
                        'A sua reserva foi efetuada com sucesso. Receberá instruções de pagamento do sinal (500€) por email. O vendedor irá contactá-lo nas próximas horas.'
                    );
                }, 300);
            });
        }

        // Confirmar Visita
        if (btnConfirmarVisita) {
            btnConfirmarVisita.addEventListener('click', function () {
                // Validação básica do formulário
                const visitaData = document.getElementById('visitaData').value;
                const visitaHora = document.getElementById('visitaHora').value;
                const visitaConfirmacao = document.getElementById('visitaConfirmacao');

                if (!visitaData || !visitaHora) {
                    alert('Por favor, preencha a data e hora para a visita.');
                    return;
                }

                if (!visitaConfirmacao.checked) {
                    alert('Por favor, confirme que compreende que a visita está sujeita à confirmação do vendedor.');
                    return;
                }

                // Simular sucesso
                const modalInstance = bootstrap.Modal.getInstance(agendarVisitaModal);
                modalInstance.hide();

                // Mostrar mensagem de sucesso
                setTimeout(() => {
                    const dataFormatada = new Date(visitaData).toLocaleDateString('pt-PT', {
                        day: 'numeric',
                        month: 'long',
                        year: 'numeric'
                    });
                    mostrarMensagemSucesso(
                        'Visita Agendada!',
                        `O seu pedido de visita para ${dataFormatada} às ${visitaHora} foi enviado. O vendedor irá confirmar a disponibilidade em breve.`
                    );
                }, 300);
            });
        }

        // Função auxiliar para mostrar mensagens de sucesso
        function mostrarMensagemSucesso(titulo, mensagem) {
            // Criar elemento de alerta
            const alertDiv = document.createElement('div');
            alertDiv.className = 'alert alert-success alert-dismissible fade show position-fixed top-0 start-50 translate-middle-x mt-3';
            alertDiv.style.zIndex = '9999';
            alertDiv.style.minWidth = '400px';
            alertDiv.style.maxWidth = '600px';
            alertDiv.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="bi bi-check-circle-fill me-3 fs-3"></i>
                    <div class="flex-grow-1">
                        <h6 class="alert-heading fw-bold mb-1">${titulo}</h6>
                        <p class="mb-0 small">${mensagem}</p>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            `;

            document.body.appendChild(alertDiv);

            // Remover automaticamente após 8 segundos
            setTimeout(() => {
                alertDiv.classList.remove('show');
                setTimeout(() => alertDiv.remove(), 150);
            }, 8000);
        }
    });
</script>
