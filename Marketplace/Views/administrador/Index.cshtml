@{
    ViewData["Title"] = "Painel de Administração";
}

<div class="container mt-5 pt-5">
    <div class="row">
        <!-- Coluna da Esquerda: Menu de Navegação Lateral -->
        <div class="col-md-3">

            <!-- Cartão de Perfil do Admin -->
            <div class="card shadow-sm mb-3 admin-profile-card">
                <div class="card-body text-center">
                    <img src="https://placehold.co/100x100/343a40/ffffff?text=Admin" alt="Foto do Administrador" class="rounded-circle mb-3">
                    <h5 class="card-title mb-0">Adminstrador Principal</h5>
                    <p class="card-text text-muted small">admin@marketplace404.pt</p>
                </div>
            </div>

            <!-- Menu de Navegação -->
            <div class="card shadow-sm">
                <div class="list-group list-group-flush admin-sidebar">
                    <a href="#" class="list-group-item list-group-item-action active" data-target="#dashboard-content">
                        <i class="bi bi-speedometer2 me-2"></i>Dashboard
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-target="#validar-vendedores-content">
                        <i class="bi bi-person-check-fill me-2"></i>Validar Vendedores
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-target="#gerir-utilizadores-content">
                        <i class="bi bi-people-fill me-2"></i>Gerir Utilizadores
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-target="#moderar-anuncios-content">
                        <i class="bi bi-megaphone-fill me-2"></i>Moderar Anúncios
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-target="#gerir-denuncias-content">
                        <i class="bi bi-flag-fill me-2"></i>Gerir Denúncias
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-target="#estatisticas-content">
                        <i class="bi bi-graph-up-arrow me-2"></i>Estatísticas
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-target="#historico-acoes-content">
                        <i class="bi bi-clock-history me-2"></i>Histórico de Ações
                    </a>
                </div>
            </div>

            <!-- Estatísticas foram removidas da barra lateral -->

        </div>

        <!-- Coluna da Direita: Conteúdo Principal Dinâmico -->
        <div class="col-md-9">

            <!-- Secção Dashboard (Conteúdo alterado) -->
            <div id="dashboard-content" class="admin-content-section">
                <div class="card shadow-sm">
                    <div class="card-body p-4">
                        <h3 class="mb-4">Bem-vindo, Administrador!</h3>
                        <p class="lead">Selecione uma opção no menu à esquerda para começar a gerir a plataforma.</p>

                        <!-- Estatísticas Movidas para o Dashboard -->
                        <div class="row mt-4 mb-4">
                            <div class="col-md-4">
                                <div class="card shadow-sm dashboard-stat-card stat-primary">
                                    <div class="card-body d-flex justify-content-between align-items-center">
                                        <div>
                                            <h5 class="card-title fs-6 mb-0">Utilizadores Ativos</h5>
                                            <div class="display-6 fw-bold">1,254</div>
                                        </div>
                                        <i class="bi bi-people-fill fs-2 text-primary opacity-25"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card shadow-sm dashboard-stat-card stat-success">
                                    <div class="card-body d-flex justify-content-between align-items-center">
                                        <div>
                                            <h5 class="card-title fs-6 mb-0">Anúncios Ativos</h5>
                                            <div class="display-6 fw-bold">832</div>
                                        </div>
                                        <i class="bi bi-megaphone-fill fs-2 text-success opacity-25"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card shadow-sm dashboard-stat-card stat-warning">
                                    <div class="card-body d-flex justify-content-between align-items-center">
                                        <div>
                                            <h5 class="card-title fs-6 mb-0">A Validar</h5>
                                            <div class="display-6 fw-bold">12</div>
                                        </div>
                                        <i class="bi bi-person-check-fill fs-2 text-warning opacity-25"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <hr class="my-4">
                        <p>Aqui pode validar novos vendedores, moderar anúncios, gerir denúncias e consultar o estado geral do Marketplace 404.</p>
                    </div>
                </div>
            </div>

            <!-- ======================= Conteúdo: Validar Vendedores ======================= -->
            <div id="validar-vendedores-content" class="admin-content-section" style="display: none;">
                <div class="card shadow-sm">
                    <div class="card-body p-4">
                        <h3 class="mb-4">Validar Vendedores</h3>
                        <p class="text-muted">Abaixo estão os pedidos de registo de vendedor que aguardam a sua aprovação.</p>

                        <!-- Tabela de Vendedores Pendentes -->
                        <div class="table-responsive">
                            <table class="table table-hover align-middle">
                                <thead class="table-light">
                                    <tr>
                                        <th scope="col">Utilizador</th>
                                        <th scope="col">Data de Pedido</th>
                                        <th scope="col">NIF (para validação)</th>
                                        <th scope="col">Estado</th>
                                        <th scope="col" class="text-end">Ações</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Exemplo de Vendedor 1: Pendente -->
                                    <tr>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <img src="https://placehold.co/40x40/EBF4FF/1E63FF?text=JP" alt="Avatar" class="rounded-circle me-3">
                                                <div>
                                                    <div class="fw-bold">João Pereira</div>
                                                    <div class="small text-muted">joao.pereira@email.com</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td>22/10/2025</td>
                                        <td>
                                            <span class="font-monospace">211345678</span>
                                            <!-- Botão de copiar (estático) -->
                                            <button class="btn btn-sm btn-link p-0 ms-1" onclick="alert('NIF copiado! (funcionalidade a implementar)')"><i class="bi bi-clipboard"></i></button>
                                        </td>
                                        <td>
                                            <span class="badge bg-warning-soft text-dark">Pendente</span>
                                        </td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-success"><i class="bi bi-check-circle me-1"></i> Aprovar</button>
                                            <button class="btn btn-sm btn-outline-danger"><i class="bi bi-x-circle me-1"></i> Rejeitar</button>
                                            <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#validarVendedorModal"><i class="bi bi-eye me-1"></i> Ver</button>
                                        </td>
                                    </tr>
                                    <!-- Exemplo de Vendedor 2: Pendente -->
                                    <tr>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <img src="https://placehold.co/40x40/FFF3E0/FFA000?text=MS" alt="Avatar" class="rounded-circle me-3">
                                                <div>
                                                    <div class="fw-bold">Maria Santos</div>
                                                    <div class="small text-muted">msantos@email.com</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td>21/10/2025</td>
                                        <td>
                                            <span class="font-monospace">255678123</span>
                                            <button class="btn btn-sm btn-link p-0 ms-1" onclick="alert('NIF copiado! (funcionalidade a implementar)')"><i class="bi bi-clipboard"></i></button>
                                        </td>
                                        <td>
                                            <span class="badge bg-warning-soft text-dark">Pendente</span>
                                        </td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-success"><i class="bi bi-check-circle me-1"></i> Aprovar</button>
                                            <button class="btn btn-sm btn-outline-danger"><i class="bi bi-x-circle me-1"></i> Rejeitar</button>
                                            <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#validarVendedorModal"><i class="bi bi-eye me-1"></i> Ver</button>
                                        </td>
                                    </tr>
                                    <!-- Exemplo de Vendedor 3: Rejeitado -->
                                    <tr>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <img src="https://placehold.co/40x40/F0F3F5/6C757D?text=RG" alt="Avatar" class="rounded-circle me-3">
                                                <div>
                                                    <div class="fw-bold">Rui Gonçalves</div>
                                                    <div class="small text-muted">rui.g@email.com</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td>20/10/2025</td>
                                        <td>
                                            <span class="font-monospace">123123123</span>
                                            <button class="btn btn-sm btn-link p-0 ms-1" onclick="alert('NIF copiado! (funcionalidade a implementar)')"><i class="bi bi-clipboard"></i></button>
                                        </td>
                                        <td>
                                            <span class="badge bg-danger-soft">Rejeitado</span>
                                        </td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-outline-secondary" disabled>Ações</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ======================= Conteúdo: Gerir Utilizadores ======================= -->
            <div id="gerir-utilizadores-content" class="admin-content-section" style="display: none;">
                <div class="card shadow-sm">
                    <div class="card-body p-4">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h3 class="mb-0">Gerir Utilizadores</h3>
                            <!-- Botão para abrir o modal -->
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#criarUtilizadorModal">
                                <i class="bi bi-plus-circle me-1"></i> Criar Novo ADMINISTRADOR
                            </button>
                        </div>

                        <!-- Tabela de Utilizadores -->
                        <div class="table-responsive">
                            <table class="table table-hover align-middle">
                                <thead class="table-light">
                                    <tr>
                                        <th scope="col">Nome</th>
                                        <th scope="col">Email</th>
                                        <th scope="col">Tipo de Conta</th>
                                        <th scope="col">Estado</th>
                                        <th scope="col" class="text-end">Ações</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Exemplo de Utilizador 1 -->
                                    <tr>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <img src="https://placehold.co/40x40/EBF4FF/1E63FF?text=AS" alt="Avatar" class="rounded-circle me-3">
                                                <div>
                                                    <div class="fw-bold">Ana Silva</div>
                                                    <div class="small text-muted">as.silva@email.com</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td>as.silva@email.com</td>
                                        <td>
                                            <span class="badge bg-primary-soft">Comprador</span>
                                        </td>
                                        <td>
                                            <span class="badge bg-success-soft">Ativo</span>
                                        </td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil me-1"></i> Editar</button>
                                            <button class="btn btn-sm btn-outline-danger"><i class="bi bi-lock me-1"></i> Bloquear</button>
                                        </td>
                                    </tr>
                                    <!-- Exemplo de Utilizador 2 -->
                                    <tr>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <img src="https://placehold.co/40x40/F0F3F5/6C757D?text=BV" alt="Avatar" class="rounded-circle me-3">
                                                <div>
                                                    <div class="fw-bold">Bruno Vieira</div>
                                                    <div class="small text-muted">bruno.v@email.com</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td>bruno.v@email.com</td>
                                        <td>
                                            <span class="badge bg-info-soft">Vendedor</span>
                                        </td>
                                        <td>
                                            <span class="badge bg-danger-soft">Bloqueado</span>
                                        </td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil me-1"></i> Editar</button>
                                            <button class="btn btn-sm btn-outline-success"><i class="bi bi-unlock me-1"></i> Desbloquear</button>
                                        </td>
                                    </tr>
                                    <!-- Exemplo de Utilizador 3 -->
                                    <tr>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <img src="https://placehold.co/40x40/FFF3E0/FFA000?text=CR" alt="Avatar" class="rounded-circle me-3">
                                                <div>
                                                    <div class="fw-bold">Carla Ribeiro</div>
                                                    <div class="small text-muted">c.ribeiro@email.com</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td>c.ribeiro@email.com</td>
                                        <td>
                                            <span class="badge bg-primary-soft">Comprador</span>
                                            <span class="badge bg-info-soft">Vendedor</span>
                                        </td>
                                        <td>
                                            <span class="badge bg-success-soft">Ativo</span>
                                        </td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil me-1"></i> Editar</button>
                                            <button class="btn btn-sm btn-outline-danger"><i class="bi bi-lock me-1"></i> Bloquear</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ======================= Conteúdo: Moderar Anúncios ======================= -->
            <div id="moderar-anuncios-content" class="admin-content-section" style="display: none;">
                <div class="card shadow-sm">
                    <div class="card-body p-4">
                        <h3 class="mb-4">Moderar Anúncios</h3>

                        <!-- Tabela de Anúncios -->
                        <div class="table-responsive">
                            <table class="table table-hover align-middle">
                                <thead class="table-light">
                                    <tr>
                                        <th scope="col" style="width: 120px;">Anúncio</th>
                                        <th scope="col">Título</th>
                                        <th scope="col">Estado</th>
                                        <th scope="col">Notas</th>
                                        <th scope="col" class="text-end">Ações</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Exemplo de Anúncio 1 -->
                                    <tr>
                                        <td>
                                            <img src="~/imagens/bmwSerie1.jpg" alt="[Imagem de um BMW Série 1]" class="rounded me-3" style="width: 100px; height: 60px; object-fit: cover;">
                                        </td>
                                        <td>
                                            <div class="fw-bold">BMW Série 1 116d</div>
                                            <div class="small text-muted">Vendedor: Ana Silva</div>
                                        </td>
                                        <td><span class="badge bg-success-soft">Ativo</span></td>
                                        <td class="small">--</td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pause-circle me-1"></i> Pausar</button>
                                            <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash me-1"></i> Remover</button>
                                        </td>
                                    </tr>
                                    <!-- Exemplo de Anúncio 2 -->
                                    <tr>
                                        <td>
                                            <img src="https://placehold.co/100x60/F0F3F5/6C757D?text=Audi+A3" alt="[Imagem de um Audi A3]" class="rounded me-3" style="width: 100px; height: 60px; object-fit: cover;">
                                        </td>
                                        <td>
                                            <div class="fw-bold">Audi A3 2.0 TDI (Fotos Falsas)</div>
                                            <div class="small text-muted">Vendedor: Bruno Vieira</div>
                                        </td>
                                        <td><span class="badge bg-danger-soft">Removido</span></td>
                                        <td class="small">Anúncio removido por violar termos (fotos).</td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-outline-secondary" disabled>Pausar</button>
                                            <button class="btn btn-sm btn-outline-success"><i class="bi bi-arrow-counterclockwise me-1"></i> Restaurar</button>
                                        </td>
                                    </tr>
                                    <!-- NOVO Exemplo de Anúncio 3 -->
                                    <tr>
                                        <td>
                                            <img src="https://placehold.co/100x60/FFF3E0/FFA000?text=VW+Golf" alt="[Imagem de um VW Golf]" class="rounded me-3" style="width: 100px; height: 60px; object-fit: cover;">
                                        </td>
                                        <td>
                                            <div class="fw-bold">VW Golf 1.6 TDI</div>
                                            <div class="small text-muted">Vendedor: Miguel Costa</div>
                                        </td>
                                        <td><span class="badge bg-warning-soft text-dark">Pendente de Revisão</span></td>
                                        <td class="small">Anúncio novo, aguarda primeira aprovação.</td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-success"><i class="bi bi-check-circle me-1"></i> Aprovar</button>
                                            <button class="btn btn-sm btn-outline-danger"><i class="bi bi-x-circle me-1"></i> Rejeitar</button>
                                        </td>
                                    </tr>

                                    <!-- NOVO Exemplo de Anúncio 4 -->
                                    <tr>
                                        <td>
                                            <img src="https://placehold.co/100x60/EBF4FF/1E63FF?text=Peugeot+208" alt="[Imagem de um Peugeot 208]" class="rounded me-3" style="width: 100px; height: 60px; object-fit: cover;">
                                        </td>
                                        <td>
                                            <div class="fw-bold">Peugeot 208 Elétrico</div>
                                            <div class="small text-muted">Vendedor: Carla Ribeiro</div>
                                        </td>
                                        <td><span class="badge bg-success-soft">Ativo</span></td>
                                        <td class="small text-danger"><i class="bi bi-exclamation-triangle-fill me-1"></i> 1 Denúncia Recebida</td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-outline-warning"><i class="bi bi-eye me-1"></i> Ver Denúncia</button>
                                            <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pause-circle me-1"></i> Pausar</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Secção Gerir Denúncias -->
            <div id="gerir-denuncias-content" class="admin-content-section" style="display: none;">
                <div class="card shadow-sm">
                    <div class="card-body p-4">
                        <h3 class="mb-4">Gerir Denúncias</h3>
                        <div class="table-responsive">
                            <table class="table table-hover align-middle">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Tipo</th>
                                        <th>Motivo</th>
                                        <th>Estado</th>
                                        <th class="text-end">Ações</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>#D1024</td>
                                        <td>Utilizador</td>
                                        <td>Comportamento abusivo</td>
                                        <td><span class="badge bg-danger-soft">Aberta</span></td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-primary">Analisar</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>#D1023</td>
                                        <td>Anúncio</td>
                                        <td>Fotografias falsas</td>
                                        <td><span class="badge bg-secondary-soft">Fechada</span></td>
                                        <td class="text-end">
                                            <button class="btn btn-sm btn-outline-secondary">Ver Detalhes</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ... código existente ... --><!-- Secção Estatísticas --><div id="estatisticas-content" class="admin-content-section" style="display: none;">
                <div class="card shadow-sm">
                    <div class="card-body p-4">
                        <h3 class="mb-4">Estatísticas Detalhadas</h3>

                        <!-- Gráfico de Variação de Vendas --><div class="row mb-4">
                            <div class="col-12">
                                <div class="card shadow-sm border-0">
                                    <div class="card-header bg-white border-0">
                                        <h5 class="mb-0">Variação de Vendas nos Últimos 6 Meses</h5>
                                    </div>
                                    <div class="card-body">
                                        <img src="~/imagens/6meses.png" class="img-fluid rounded" alt="[Gráfico de linha de variação de vendas]">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6 mb-4">
                                <div class="card shadow-sm border-0">
                                    <div class="card-header bg-white border-0">
                                        <h5 class="mb-0">Top Marcas/Modelos</h5>
                                    </div>
                                    <div class="card-body">
                                        <img src="~/imagens/marcasvendidas.png" class="img-fluid rounded" alt="[Gráfico doughnut de top marcas]">
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="card shadow-sm border-0">
                                    <div class="card-header bg-white border-0">
                                        <h5 class="mb-0">Distribuição de Anúncios por Estado</h5>
                                    </div>
                                    <div class="card-body">
                                        <img src="~/imagens/estadosAnuncios.png" class="img-fluid rounded" alt="[Gráfico de distribuição de anúncios por estado]">
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- Secção Histórico de Ações -->
            <div id="historico-acoes-content" class="admin-content-section" style="display: none;">
                <div class="card shadow-sm">
                    <div class="card-body p-4">
                        <h3 class="mb-4">Histórico de Ações Administrativas</h3>
                        <div class="table-responsive">
                            <table class="table table-hover align-middle">
                                <thead>
                                    <tr>
                                        <th>Data/Hora</th>
                                        <th>Administrador</th>
                                        <th>Ação</th>
                                        <th>Detalhes</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>21/10/2025 15:30</td>
                                        <td>admin@marketplace.com</td>
                                        <td>Bloqueou Utilizador</td>
                                        <td>Utilizador "Rui Santos" bloqueado por fraude.</td>
                                    </tr>
                                    <tr>
                                        <td>21/10/2025 11:15</td>
                                        <td>admin@marketplace.com</td>
                                        <td>Removeu Anúncio</td>
                                        <td>Anúncio #A5543 removido por conteúdo impróprio.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Script para controlar a navegação por abas no painel de administração
        document.addEventListener('DOMContentLoaded', function () {
            const sidebarLinks = document.querySelectorAll('.admin-sidebar .list-group-item-action');
            const contentSections = document.querySelectorAll('.admin-content-section');

            sidebarLinks.forEach(link => {
                link.addEventListener('click', function (event) {
                    event.preventDefault();

                    // Esconde todas as outras secções
                    contentSections.forEach(section => {
                        section.style.display = 'none';
                    });

                    // Mostra a secção correspondente ao link clicado
                    const targetId = this.getAttribute('data-target');
                    const targetSection = document.querySelector(targetId);
                    if (targetSection) {
                        targetSection.style.display = 'block';
                    }

                    // Atualiza o item ativo no menu
                    sidebarLinks.forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                });
            });
 

             // Gráfico 1: Novos Registos (Gráfico de Barras)
           
            // --- FIM DO CÓDIGO DOS GRÁFICOS ---
        });
    </script>
}

